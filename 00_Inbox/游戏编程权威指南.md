# 游戏中有什么

## 游戏架构

采取自顶向下的方式可以将游戏分为三层：

- 应用层：关注运行游戏的机器。包括处理硬件、操作系统服务的代码。
- 逻辑层：主要是与游戏直接相关的代码。
- 视图层：负责显示游戏状态，将输入转为为可以发送给游戏逻辑的游戏命令。一种针对玩家，一种针对AI代理，另一种针对网络中的远程玩家。

## 使用游戏架构

游戏逻辑的输出是状态变化和事件，会被发送到游戏视图。

人物视图和AI视图发送给游戏逻辑的命令是相同的，特定的游戏逻辑可以有多个人物和AI视图。

可以创建特殊的DVR游戏视图，用于将游戏事件记录到缓冲区并回放它们。

还可以创建特殊的远程游戏视图，将游戏状态和事件发送给网络上的远程玩家。

## 应用层

应用层可分为处理设备、操作系统和游戏生命周期模块。

### 读取输入

读取输入设备几乎完全依赖对操作系统和设备驱动的调用，可以编写完整的子系统来读取这些设备，并将输入解释为命令。

输入系统还应该是可配置的。

读取用户输入时，不能只是直接修改游戏状态。

### 文件系统和资源缓存

文件系统负责从存储系统中读取数据并写回，该子系统通常管理游戏的源文件、加载和保存游戏状态。

资源缓存指的是将那些常用的素材保持在内存中，而不常用的则只在需要时加载。

### 内存管理

对于游戏应用来说，通常都需要自己编写内存管理器来处理各种内存的分配。

### 初始化、主循环和关闭

主循环主要由三部分组成：获取并对玩家输入排序、标记游戏逻辑、在所有游戏视图中显示游戏状态。

### 其他应用层代码

- 系统时钟
- 字符串处理
- 动态加载库
- 线程和线程同步
- 网络通信

## 游戏逻辑

游戏逻辑是游戏的核心，定义了游戏世界和其中内容之间的交互方式以及外部刺激如何改变游戏状态。

### 游戏状态和数据结构

游戏引擎必须能快速遍历对象数据结构来修改某个对象的状态，还必须能够保存每个对象的灵活特性。

游戏逻辑保存的是对象的状态，而由游戏视图管理的可视化表示保存的是模型数据和形象化地将状态表现给玩家的纹理。

当游戏逻辑数据发生改变时就会发送一个事件，用来通知所有的子系统。

