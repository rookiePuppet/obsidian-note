## 行列式

可以将行列式看作是向量相乘的一种方式。

对于二维向量来说，$|ab|$就是a和b形成的平行四边形的面积，这个面积是有方向（符号）的，当a在b的右边时（right-handed）是正的，a在b的左边时是负的。

对于三维向量a、b、c来说，$|abc|$就是a、b、c形成的平行六面体的体积。

> [!NOTE]
> 以2D为例，right-handed的意思是将一个向量逆时针旋转到另一个向量的位置，并且旋转的角度要是最小的（小于180°）。

由于伸缩平行四边形的一条边相当于以同样倍率伸缩平行四边形的面积，可以得出如下性质：

$$
|(ka)b=|a(kb)|=k|ab|
$$

另外，斜切一个平行四边形时不会改变其面积：

$$
|(a+kb)b|=|a(b+ka)|=|ab|
$$
![[Pasted image 20250527160917.png]]

左边的两个平行四边形经过斜切之后可以得到右边的一个大的平行四边形，两者的面积相同，可以得出：

$$
|a(b+c)|=|ab|+|ac|
$$

当我们想要计算一个向量关于另外两个向量的线性组合时，行列式就自然出现了。

$$
c=a_ca+b_cb
$$

![[Pasted image 20250527162408.png]]

根据斜切面积不变的性质，可以得出：

$$
|(b_cb)a|=|ca|
$$
$$
b_c=\frac{|ca|}{|ba|}
$$
$$
a_c=\frac{|bc|}{|ba|}
$$

## 矩阵

矩阵是一组遵循特定算术规则的数字，在计算机图形学中常用于各种意图例如表示空间变换。

### 矩阵算术

常数和矩阵相乘：常数和矩阵中的每个元素相乘。

矩阵和矩阵相加：矩阵中的每个位置的元素对应相加。

矩阵和矩阵相乘：用第一个矩阵的每一行乘以第二个矩阵的每一列。

只有当第一个矩阵的列数等于第二个矩阵的行数时，才能相乘。

矩阵乘法不满足交换律，满足结合律和分布律。

### 矩阵上的操作

我们用单位矩阵$I$来表示矩阵当中的1，它仅在方形矩阵中成立。例如一个4×4的单位矩阵：

$$
I=\left [
\begin{matrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
\end{matrix}
\right ]
$$

矩阵A与其逆矩阵$A{-1}$相乘的结果是一个单位矩阵。

$$
AA^{-1}=I
$$

矩阵相乘的逆等于矩阵的逆相乘，但顺序需要调换。

$$
(AB)^{-1}=B^{-1}A^{-1}
$$

矩阵转置是将矩阵的行元素与列元素位置互换。

矩阵相乘的转置性质和逆类似。

$$
(AB)^{T}=B^{T}A^{T}
$$

行列式与矩阵操作的一些关系：

$$
\begin{align}
|AB|=|A||B|\\
|A^{-1}|=\frac{1}{|A|}\\
|A^{T}|=|A|
\end{align}
$$

### 矩阵形式的向量操作

矩阵和向量相乘有两种方式：

1. 向量作为列向量乘在矩阵的右边
2. 向量作为行向量乘在矩阵（转置）的左边

例如将向量$a=(x_a,y_a)$绕原点旋转90°得到向量$a^{'}=(-y_a,x_a)$，以下两种方式是等价的：

$$
\left[
\begin{matrix}
0 & -1 \\
1 & 0 
\end{matrix}
\right]
\left[
\begin{matrix}
x_a \\
y_a
\end{matrix}
\right]
=
\left[
\begin{matrix}
-y_a \\
x_a
\end{matrix}
\right] \\
$$
$$
\left[
\begin{matrix}
x_a & y_a
\end{matrix}
\right]
\left[
\begin{matrix}
0 & 1 \\
-1 & 0 
\end{matrix}
\right]
=
\left[
\begin{matrix}
-y_a & x_a
\end{matrix}
\right] \\
$$

两个向量的点乘可以写成如下矩阵形式，左边用行向量，右边用列向量。

$$
a·b=a^{T}b
$$

两个向量的叉乘可以写成如下矩阵形式，左边用列向量，右边用行向量。

$$
a×b=ab^{T}
$$

在三维中可以将3×3矩阵看作是3个列向量，也可以看作是3个行向量。

例如$y=Ax$可以解释为一个所有元素分别是x与A的每一行点乘结果的向量，也可以看作x的各个分量分别与A的每一列相乘的结果。

### 特殊矩阵

单位矩阵是一种对角矩阵，其所有非零元素都在对角线（行索引=列索引）上。

单位矩阵也是一种对称矩阵，其转置和本身相等。

单位矩阵也是正交矩阵，因为它的每一列/行都是单位向量并且每一列/行互相垂直。

所有正交矩阵的行列式都是1或-1。

正交矩阵的一个非常有用的特性是其转置矩阵等于其逆矩阵。

$$
R^{T}R=I=RR^{T}
$$

## 使用矩阵和行列式进行计算

矩阵的行列式和矩阵转置的行列式结果相同。

### 计算矩阵的逆

$$
A^{-1}=\frac{1}{|A|}A^{adj}
$$

伴随矩阵（adjoint）是矩阵的余子式矩阵的转置。

> 为什么矩阵A和它的伴随矩阵相乘能得到对角元素为$|A|$、其它元素为零的矩阵？

$$
\left[
\begin{matrix}
a_{11} & a_{12} & a_{13} & a_{14} \\
a_{21} & a_{22} & a_{23} & a_{24} \\
a_{31} & a_{32} & a_{33} & a_{34} \\
a_{41} & a_{42} & a_{43} & a_{44} \\
\end{matrix}
\right]
\left[
\begin{matrix}
a_{11}^c & a_{12}^c & a_{13}^c & a_{14}^c \\
a_{21}^c & a_{22}^c & a_{23}^c & a_{24}^c \\
a_{31}^c & a_{32}^c & a_{33}^c & a_{34}^c \\
a_{41}^c & a_{42}^c & a_{43}^c & a_{44}^c \\
\end{matrix}
\right]
=
\left[
\begin{matrix}
|A| & 0 & 0 & 0 \\
0 & |A| & 0 & 0 \\
0 & 0 & |A| & 0 \\
0 & 0 & 0 & |A| \\
\end{matrix}
\right]
$$

首先考虑对角线元素，例如矩阵A的第一行点乘伴随矩阵的第一列，其结果其实就是矩阵A按第一行展开的行列式|A|（拉普拉斯展开）。

然后考虑非对角线元素，例如矩阵A的第二行点乘伴随矩阵的第一列，其结果其实就是将矩阵A的第一行替换成第二行后按第一行展开的行列式，由于替换行后的矩阵的第一行和第二行相同，它是一个奇异矩阵，因此行列式为0。

### 线性系统

在图形中经常会遇到“n个方程和n个未知数”的线性系统，一般n=2或n=3，例如：

$$
\begin{align}
3x+7y+2z=4,\\
2x-4y-3z=-1,\\
5x+2y+z=1.
\end{align}
$$

可以把它写成矩阵形式：

$$
\left[
\begin{matrix}
3 & 7 & 2 \\
2 & -4 & -3 \\
5 & 2 & 1
\end{matrix}
\right]
\left[
\begin{array}{c}
x \\ y \\ z
\end{array}
\right]
=
\left[
\begin{array}{c}
4 \\ -1 \\ 1
\end{array}
\right]
$$

常常简写为$Ax=b$，A代表的是一个包含已知数的方阵，x是一个未知数的列向量，b是一个已知数的列向量。

计算这种系统的方法有很多，不同规模的矩阵适合用不同的方法。由于在图形当中一般n<=4，因此我们主要讨论克拉默法则（Cramer's rule）。

下面是使用克拉默法则计算上述线性系统的方法，其中$|A^{x'}|$、$|A^{y'}|$、$|A^{z'}|$分别表示将$b$替换到矩阵A的第一列、第二列和第三列。

$$
x=\frac {|A^{x'}|}{|A|};\quad
y=\frac {|A^{y'}|}{|A|};\quad
z=\frac {|A^{z'}|}{|A|}.
$$

若$|A|=0$，则该线性系统是无解的。这也说明了当矩阵A是奇异矩阵时，其组成的线性系统无解。

## 特征值和矩阵对角化

方阵都有和它关联的特征值和特征向量。

**特征向量**指的是一个非零的，并且和矩阵相乘后不会改变方向的向量。

假设有一个矩阵A和一个向量a：

$$
Aa=\lambda a
$$

这意味着我们对向量a进行拉伸或压缩，但是它的方向始终不变。缩放因子$\lambda$被称为和特征向量相关的**特征值**。

如果假设一个矩阵至少有一个特征向量，那么我们可以做以下操作来找到它。

首先将等式两边都表示为一个方阵乘以向量a：

$$
Aa=\lambda Ia
$$
然后将右边移到左边，并利用矩阵操作可结合的特性，将矩阵部分组合在一起：

$$
(A-\lambda I)a=0
$$

仅当$A-\lambda I$是奇异矩阵时，这条等式才能成立。

对于2x2的矩阵，其特征值遵循：

$$
\left|
\begin{matrix}
a_{11}-\lambda & a_{12} \\
a_{21} & a_{22}-\lambda
\end{matrix}
\right|
=
\lambda^2-(a_{11}+a_{22})\lambda+(a_{11}a_{22}+a_{12}a_{21})=0
$$

对nxn的矩阵做类似的操作会得到一个关于$\lambda$的n次多项式方程。

因为在一般情况下，无法得出大于4次的多项式方程的确切解，我们只能通过分析的方法来计算4x4及更小的矩阵的特征值，对于更大的矩阵，只能依靠数值方法。

对称矩阵（转置和本身相等）是一个重要的特例，它的特征值和特征向量尤其简单。

实对称矩阵的特征值永远是实数，而且如果它们是不相等的，它们的特征向量就会相互正交。这样的矩阵可以写成对角形式：

$$
A=QDQ^T
$$

其中Q是一个正交矩阵，其列是A的特征向量；D是一个对角矩阵，其对角元素是A的特征值。

将A写作这种形式也被叫做**特征值解构**，因为它将A分解成了附带其特征向量与特征值的更简单的矩阵的乘积。

对于给出的矩阵A：

$$
A=\left[
\begin{matrix}
2 & 1 \\
1 & 1
\end{matrix}
\right]
$$

其特征值是如下方程的解：

$$
\lambda^2-3\lambda+1=0
$$

计算得到近似的解为：

$$
\lambda=\frac{3\pm\sqrt 5}{2},\quad\approx\left[\begin{array}{c}0.618\\0.382\end{array}\right]
$$

使用第一个特征值代入$(A-\lambda I)a=0$计算特征向量：

$$
\left[
\begin{matrix}
2-2.618 & 1 \\
1 & 1-2.618
\end{matrix}
\right]
\left[
\begin{array}{c}
x \\ y
\end{array}
\right]
=
\left[
\begin{array}{c}
0 \\ 0
\end{array}
\right]
$$

得到$(x,y)=(0.8507,0.5257)$，注意这只是无限多个解（平行于它）中的其一。

使用第二个特征值做类似计算可以得到$(x,y)=(-0.5257,0.8507)$。

于是，得到矩阵A的对角形式如下：

$$
\left[
\begin{matrix}
2 & 1 \\
1 & 1 
\end{matrix}
\right]
=
\left[
\begin{matrix}
0.8507 & -0.5257 \\
0.5257 & 0.8507 
\end{matrix}
\right]
\left[
\begin{matrix}
2.618 & 0 \\
0 & 0.382
\end{matrix}
\right]
\left[
\begin{matrix}
0.8507 & 0.5257 \\
-0.5257 & 0.8507 
\end{matrix}
\right]
$$

### 奇异值解构

计算矩阵（尤其非对称矩阵）的特征值和特征向量还有一种更通用的方法，即奇异值解构（SVD）。

奇异值解构和特征值解构的主要区别在于，对非对称矩阵做奇异值解构时左右两边的正交矩阵不要求相等。

$$
A=USV^T
$$

其中U和V是两个可能不相同的正交矩阵，其列是A的左右奇异向量。S是一个对角矩阵，对角元素是A的奇异值。当A对称并拥有非零特征值时，奇异值解构和特征值解构是等同的。

奇异值和特征值之间还有一个关系可以用来计算SVD，首先我们定义$M=AA^T$，假设可以对M执行SVD：

$$
M=AA^T=(USV^T)(USV^T)^T=US(V^TV)SU^T=US^2U^T
$$

于是我们发现奇异值就是矩阵和其转置的乘积的特征值的平方根，而左奇异向量就是乘积的特征向量。

