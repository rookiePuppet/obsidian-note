在图像中找出被几何体占据的像素的过程，称为**光栅化**，物体顺序渲染也可以称为光栅化渲染。该过程所需的一系列操作——使物体转化为图像上的像素，就是**图形管线**。

> [!NOTE]
> 任何图形系统都有多种类型的图元对象，能够被直接处理，三角形就是其中一种，更复杂的对象都会被转换成这些图元。

对于大型场景，数据访问模式的管理非常影响性能。利用一个单独通道来一次性访问场景中的每一个几何，比重复搜索像素着色所需的物体更加高效。

两种类型的图形管线有着非常不同的目标：硬件管线通过像OpenGL和Direct3D这种API，被用于提供交互式渲染；软件管线提供像RenderMan这种API，被用于电影制作。硬件管线必须运行得足够快，以对游戏、可视化和用户界面实时反应。软件管线必须以最高质量渲染动画和视觉特效并是适应巨大的场景，而需要更多的时间。

物体顺序渲染需要完成的工作可分为三个部分：光栅化处理本身，光栅化之前的几何操作以及光栅化之后的像素操作。

最常见的几何操作是应用矩阵变换，将定义几何的点从模型空间映射到屏幕空间，从而使光栅器的输入以（屏幕空间中的）像素坐标表示。最常见的像素操作是**隐藏表面消除**，将更靠近观察者的表面组织到远离观察者的表面之前。

![[Pasted image 20250626172610.png]]

几何体数据一般被描述为顶点集，来自于交互式应用或场景描述文件中。这些顶点会在**顶点处理阶段**被处理，然后传递到**光栅化阶段**。光栅器将各个图元拆分成一堆**片元**，分别对应着被图元覆盖的一个像素。经过**片元处理阶段**，对应着每一个像素的各个片元在**片元混合阶段**被组合。

## 光栅化

光栅化是物体顺序渲染的核心操作，而**光栅器**是任何图形管线的核心。

光栅器会对输入的原型做两项工作：**枚举**被图元覆盖的像素并在图元表面**插值**计算属性值。光栅器的输出一个**片元**集合，一个片元对应着图元覆盖着的一个像素并携带它自己的属性集。

### 绘制直线

大多数图形库都包含绘制直线的命令，对于任意的屏幕坐标$(x_0,y_0)$和$(x_1,y_1)$，程序应该绘制一个“合理的”像素集得到两个端点之间的一条近似直线。

> 使用隐式直线方程绘制直线

使用隐式方程绘制直线的方法是**中点**算法，它和**布雷森汉姆**算法都能得到相同的结果，但在某种程度上更加直接。

首先写出这条直线的隐式方程：

$$
f(x,y)\equiv(y_0-y_1)x+(x_1-x_0)y+x_0y_1-x_1y_0=0
$$

该直线的斜率$m$为：

$$
m=\frac{y_1-y_0}{x_1-x_0}
$$

接下来的讨论假设$m\in(0,1]$，当$m\in(-\infty,-1],m\in(-1,0],m\in(1,\infty)$时也是相似的，这四种情况能覆盖所有的可能性。

