在图形学中经常需要处理连续变量的函数，在计算机中表示连续函数的最有用方法之一是使用**样本**：只需存储函数在许多个不同点的值，并在需要时重建它们之间的值。

图像就是一种样本表示，一张相片是由相机捕获的在图像平面上位置的连续函数，相机将该函数转换为二维样本网格。

## 数字音频：一维采样

在音频录制中，麦克风将声音（以空气中的压力波形式存在）转换为随时间变化的电压，相当于对麦克风所在位置空气压力变化的测量。该电信号会以某种形式存储下来，然后由扬声器通过同步移动振膜将电压转换回压力波。

![[Pasted image 20250701161032.png]]

记录音频信号的数字方法使用采样：利用一个**模数转换器**每秒测量电压数千次，生成一个整数流，可以轻松地存储在任何媒介上。

在播放时，将数据以适当的速率读取出来并传入一个**数模转换器**，根据接收到的数字产生电压。

每秒所需的样本数取决于录制声音的音调高低，对于一个可以重现贝斯或底鼓声音的采样率，如果用来录制短笛或钹，就会产生奇怪的结果。为了避免这些**欠采样伪影**，录音机会对输入信号进行**滤波**，以去除高频带来的问题。

在输出端也会出现一种问题，数模转换器在收到一个样本输入时就会变换产生的电压，但在收到样本之前会保持不变，从而产生一个阶梯状图形，形成噪声。为了去除这种**重建失真**，数字音频播放器会对数模转换器进行滤波以平滑波形。

### 采样失真与走样

图形和其他采样信号都会发生同样的欠采样和重建伪影，解决方案也都是相同的：采样前滤波和重建时再次滤波。

![[Pasted image 20250701164119.png]]

采样一旦完成，就无法判断原始信号究竟是高频还是低频正弦波，由于高频信号“伪装”成了低频信号，这种现象称为**走样**。

走样在音频中变现为奇怪的音调，在图像中通常表现为**摩尔纹**。

## 卷积

卷积是用于采样、滤波和重建算法的基础。

卷积是函数上的一个操作，它将两个函数组合起来产生一个新的函数，其运算符为$\ast$。

### 移动平均

以使用移动平均平滑一维函数为例，要在任意点上获得平滑值，我们计算函数在每个方向上扩展了距离$r$的一个范围中的平均值，$r$称为平滑操作的**半径**，用于控制平滑程度。

对于平滑连续函数$g(x)$，平均值意味着对区间积分，然后除以区间长度：

$$
h(x)=\frac{1}{2r}\int_{x-r}^{x+r}g(t)dt
$$

对于平滑离散函数$a[i]$，平均值意味着对一系列索引求和，然后除以值的数量：

$$
c[i]=\frac{1}{2r+1}\sum_{j=i-r}^{i+r}a[j]
$$

移动平均的思想是卷积的本质，唯一不同的是卷积中的移动平均是加权平均。

### 离散卷积

对离散序列$a[i]$和$[b[i]$进行卷积的结果为$(a\ast b)[i]$，这个过程就像使用移动平均对序列$a$进行平滑处理一样，但这次是从序列$b$中获取每一个样本的权重，$b[i-j]$对应位置$j$处样本的权重。

$$
(a\ast b)[i]=\sum_j a[j]b[i-j]
$$

通过省略$j$的界限，表示这个求和运行在所有整数上。

![[Pasted image 20250701172127.png]]

在图形学中，这两个函数通常有一个具有**有限支撑**，也就是说它在参数值的有限区间中才非零。假设$b$具有有限支持，那么存在某个半径$r$，使得$b[k]=0$在$|k|>r$时才成立。这种情况下，可以将上面的求和写成：

$$
(a\ast b)[i]=\sum_{j=i-r}^{i+r} a[j]b[i-j]
$$

可以用代码来描述这个定义：

![[Pasted image 20250701174550.png]]